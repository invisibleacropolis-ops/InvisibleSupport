<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hyperspace Warp Starfield</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: black;
      width: 100%;
      height: 100%;
    }
    canvas {
      position: absolute;
      top: 0;
      left: 0;
      display: block;
      pointer-events: none;
    }
  </style>
</head>
<body>

  <!-- Two canvas layers: one for main stars, one for glow/trails -->
  <canvas id="starsCanvas"></canvas>
  <canvas id="glowCanvas"></canvas>

  <script>
    // Get canvases and contexts
    const starsCanvas = document.getElementById("starsCanvas");
    const glowCanvas = document.getElementById("glowCanvas");
    const starsCtx = starsCanvas.getContext("2d");
    const glowCtx = glowCanvas.getContext("2d");

    // Resize to full window
    function resize() {
      starsCanvas.width = window.innerWidth;
      starsCanvas.height = window.innerHeight;
      glowCanvas.width = window.innerWidth;
      glowCanvas.height = window.innerHeight;
      centerX = starsCanvas.width / 2;
      centerY = starsCanvas.height / 2;
      maxDist = Math.hypot(centerX, centerY);
    }
    window.addEventListener("resize", resize);
    resize();

    // Configuration parameters (tweak as needed)
    const STAR_COUNT = 600;
    const BASE_SPEED = 0.005;     // base speed factor
    const ACCELERATION = 0.05;     // additional speed during warp
    const DECEL_RATE = 0.98;       // how fast we decay from warp
    const MAX_RADIUS = 3;
    const COLOR_VARIANCE = 30;     // hue variance

    let centerX = starsCanvas.width / 2;
    let centerY = starsCanvas.height / 2;
    let maxDist = Math.hypot(centerX, centerY);

    class Star {
      constructor() {
        this.reset();
      }
      reset() {
        // Place star at random 2D direction from center, with random depth factor
        this.angle = Math.random() * Math.PI * 2;
        this.dist = Math.random();   // in [0,1], 0 is center, 1 is outer
        this.speedFactor = 0.2 + Math.random() * 0.8; // for depth variation
        // assign a slight hue shift
        this.hue = 200 + (Math.random() * COLOR_VARIANCE - COLOR_VARIANCE/2);
      }
      update(delta, globalSpeed) {
        // Increase the dist by speed (taking into account depth)
        this.dist += globalSpeed * this.speedFactor * delta;
        if (this.dist > 1) {
          this.reset();
        }
      }
      draw(ctx) {
        // Convert from radial dist (0 to 1) to canvas coordinate
        const d = this.dist * maxDist;
        const x = centerX + Math.cos(this.angle) * d;
        const y = centerY + Math.sin(this.angle) * d;

        // Radius grows as we go outward
        const radius = (this.dist ** 1.5) * MAX_RADIUS;

        // Alpha stronger when farther
        const alpha = Math.min(1, this.dist * 1.5);

        ctx.beginPath();
        ctx.arc(x, y, radius, 0, Math.PI * 2);
        ctx.closePath();
        ctx.fillStyle = `hsla(${this.hue}, 80%, 85%, ${alpha})`;
        ctx.fill();
      }
    }

    // Create stars
    const stars = [];
    for (let i = 0; i < STAR_COUNT; i++) {
      stars.push(new Star());
    }

    let lastTime = performance.now();
    let warpSpeed = BASE_SPEED;  // current global speed factor

    function animate(time) {
      const delta = (time - lastTime) / 16.6667;  // normalized to ~60fps
      lastTime = time;

      // Slowly decay warp if above base
      warpSpeed = Math.max(BASE_SPEED, warpSpeed * DECEL_RATE);

      // Clear canvases (glow canvas is drawn with a fade to leave trails)
      starsCtx.clearRect(0, 0, starsCanvas.width, starsCanvas.height);

      // On glow canvas, draw semi-transparent black to fade previous glows
      glowCtx.fillStyle = "rgba(0, 0, 0, 0.2)";
      glowCtx.fillRect(0, 0, glowCanvas.width, glowCanvas.height);

      // Draw each star
      for (const star of stars) {
        star.update(delta, warpSpeed);
        star.draw(starsCtx);
        star.draw(glowCtx);
      }

      requestAnimationFrame(animate);
    }
    requestAnimationFrame(animate);

    // Hook up warp trigger (on mouse click / tap)
    window.addEventListener("mousedown", () => {
      warpSpeed += ACCELERATION;
    });
    window.addEventListener("touchstart", () => {
      warpSpeed += ACCELERATION;
    });

  </script>
</body>
</html>
